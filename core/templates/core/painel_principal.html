{% extends 'core/base.html' %}

{% block title %}Painel Principal - SIGA{% endblock %}

{% block content %}
<style>
    .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        width: 280px;
        height: 100vh;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        padding-top: 80px;
        overflow-y: auto;
        z-index: 1000;
    }

    .sidebar-nav {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .sidebar-nav .nav-item {
        margin: 0;
    }

    .sidebar-nav .nav-link {
        color: rgba(255, 255, 255, 0.8);
        padding: 15px 25px;
        display: block;
        text-decoration: none;
        border-left: 4px solid transparent;
        transition: all 0.3s ease;
    }

    .sidebar-nav .nav-link:hover,
    .sidebar-nav .nav-link.active {
        background-color: rgba(255, 255, 255, 0.1);
        color: #fff;
        border-left-color: #17a2b8;
    }

    .nav-category {
        padding: 15px 25px;
        font-size: 12px;
        font-weight: 700;
        color: rgba(255, 255, 255, 0.5);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 20px;
        margin-bottom: 5px;
    }

    .nav-category:first-child {
        margin-top: 0;
    }

    .main-content {
        margin-left: 280px;
        padding: 30px;
        min-height: 100vh;
        background-color: #f5f6fa;
    }

    .nav-icon {
        margin-right: 10px;
        width: 20px;
        text-align: center;
    }

    .card-widget {
        background: white;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border-left: 4px solid #1e3c72;
    }

    .card-widget.success {
        border-left-color: #28a745;
    }

    .card-widget.info {
        border-left-color: #17a2b8;
    }

    .card-widget.warning {
        border-left-color: #ffc107;
    }

    .card-widget.danger {
        border-left-color: #dc3545;
    }

    .stat-number {
        font-size: 28px;
        font-weight: 700;
        color: #1e3c72;
        margin: 10px 0;
    }

    .stat-label {
        font-size: 14px;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    @media (max-width: 768px) {
        .sidebar {
            width: 100%;
            height: auto;
            position: relative;
            padding-top: 20px;
        }
        .main-content {
            margin-left: 0;
        }
    }

    .dashboard-header {
        margin-bottom: 30px;
    }

    .dashboard-header h1 {
        color: #1e3c72;
        font-weight: 700;
        margin-bottom: 5px;
    }

    .dashboard-header p {
        color: #666;
    }
</style>

<div class="sidebar">
    <ul class="sidebar-nav">
        <div class="nav-category">Menu Principal</div>
        
        <li class="nav-item">
            <a href="{% url 'painel_principal' %}" class="nav-link active">
                <span class="nav-icon">üìä</span>
                Painel Principal
            </a>
        </li>

        <li class="nav-item">
            <a href="{% url 'dashboard' %}" class="nav-link">
                <span class="nav-icon">üìà</span>
                Dashboard
            </a>
        </li>

        <div class="nav-category">Configura√ß√µes</div>

        <li class="nav-item">
            <a href="{% url 'trocar_ano' %}" class="nav-link">
                <span class="nav-icon">üìÖ</span>
                Ano Acad√™mico
            </a>
        </li>

        <li class="nav-item">
            <a href="{% url 'perfil_usuario' %}" class="nav-link">
                <span class="nav-icon">üë§</span>
                Perfil do Usu√°rio
            </a>
        </li>

        <div class="nav-category">Gest√£o Acad√™mica</div>

        <li class="nav-item">
            <a href="{% url 'gestao_academica' %}" class="nav-link">
                <span class="nav-icon">üéì</span>
                Gest√£o Acad√™mica
            </a>
        </li>

        <li class="nav-item">
            <a href="{% url 'gestao_estudantes' %}" class="nav-link">
                <span class="nav-icon">üë®‚Äçüéì</span>
                Gest√£o de Estudantes
            </a>
        </li>

        <li class="nav-item">
            <a href="{% url 'gestao_docentes' %}" class="nav-link">
                <span class="nav-icon">üë©‚Äçüè´</span>
                Gest√£o de Docentes
            </a>
        </li>

        <div class="nav-category">Comunica√ß√£o</div>

        <li class="nav-item">
            <a href="{% url 'notificacoes' %}" class="nav-link">
                <span class="nav-icon">üîî</span>
                Notifica√ß√µes
                {% if notificacoes_nao_lidas > 0 %}
                <span class="badge badge-danger" style="margin-left: auto;">{{ notificacoes_nao_lidas }}</span>
                {% endif %}
            </a>
        </li>

        <li class="nav-item">
            <a href="{% url 'quadro_avisos' %}" class="nav-link">
                <span class="nav-icon">üìã</span>
                Quadro de Avisos
            </a>
        </li>

        <div class="nav-category">Sistema</div>

        <li class="nav-item">
            <a href="{% url 'logout' %}" class="nav-link">
                <span class="nav-icon">üö™</span>
                Sair
            </a>
        </li>
    </ul>
</div>

<div class="main-content">
    <div class="dashboard-header">
        <h1>Bem-vindo(a), {{ user.get_full_name|default:user.username }}!</h1>
        <p>Painel de Controlo - {{ now|date:"d \d\e F \d\e Y" }}</p>
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="card-widget success">
                <div class="stat-label">Total de Inscri√ß√µes</div>
                <div class="stat-number">{{ total_inscricoes }}</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card-widget info">
                <div class="stat-label">Aprovados</div>
                <div class="stat-number">{{ total_aprovados }}</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card-widget warning">
                <div class="stat-label">Aguardando Avalia√ß√£o</div>
                <div class="stat-number">{{ aguardando_nota }}</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card-widget danger">
                <div class="stat-label">N√£o Aprovados</div>
                <div class="stat-number">{{ total_reprovados }}</div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card-widget">
                <h5 style="color: #1e3c72; margin-bottom: 15px;">Informa√ß√µes do Ano Acad√™mico</h5>
                {% if ano_atual %}
                <p><strong>Per√≠odo Ativo:</strong> {{ ano_atual.ano_inicio }}/{{ ano_atual.ano_fim }}</p>
                <p><strong>Status:</strong> <span class="badge bg-success">Ativo</span></p>
                {% else %}
                <p class="text-muted">Nenhum ano acad√™mico ativo configurado.</p>
                {% endif %}
            </div>
        </div>

        <div class="col-md-6">
            <div class="card-widget">
                <h5 style="color: #1e3c72; margin-bottom: 15px;">Subscri√ß√£o Atual</h5>
                {% if subscricao %}
                <p><strong>Plano:</strong> {{ subscricao.get_plano_display }}</p>
                <p><strong>Estado:</strong> <span class="badge {% if subscricao.esta_ativo %}bg-success{% else %}bg-danger{% endif %}">{{ subscricao.get_estado_display }}</span></p>
                <p><strong>Dias Restantes:</strong> {{ subscricao.dias_restantes }} dias</p>
                {% else %}
                <p class="text-muted">Nenhuma subscri√ß√£o ativa.</p>
                {% endif %}
            </div>
        </div>
    </div>

    {% if notificacoes_recentes %}
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card-widget">
                <h5 style="color: #1e3c72; margin-bottom: 15px;">Notifica√ß√µes Recentes</h5>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    {% for notif in notificacoes_recentes %}
                    <li style="padding: 10px 0; border-bottom: 1px solid #eee;">
                        <strong>{{ notif.titulo }}</strong>
                        <p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">{{ notif.mensagem|truncatewords:20 }}</p>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}
